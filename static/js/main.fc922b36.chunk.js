(this.webpackJsonpminesweeper=this.webpackJsonpminesweeper||[]).push([[0],{10:function(e,t,n){e.exports=n(17)},15:function(e,t,n){},16:function(e,t,n){},17:function(e,t,n){"use strict";n.r(t);var i=n(0),a=n.n(i),s=n(9),h=n.n(s),r=(n(15),n(3)),o=n(1),l=n(2),u=n(5),c=n(4),d=(n(16),n(7)),g=function(e){Object(u.a)(n,e);var t=Object(c.a)(n);function n(){var e;Object(o.a)(this,n);for(var i=arguments.length,a=new Array(i),s=0;s<i;s++)a[s]=arguments[s];return(e=t.call.apply(t,[this].concat(a))).state={width:0,height:0,mines:0,mode:!1,err:""},e}return Object(l.a)(n,[{key:"componentDidMount",value:function(){var e=this.props,t=e.width,n=e.height,i=e.mines,a=e.mode;this.setState({width:t,height:n,mines:i,mode:a})}},{key:"handleInputChange",value:function(e){var t=e.target,n=t.value,i=t.name;!isNaN(n)&&n>=0&&this.setState(Object(d.a)({},i,n))}},{key:"handleSubmit",value:function(e){if(e.preventDefault(),this.validate()){var t=Object(r.a)(Object(r.a)({},this.state),{},{mode:!1,err:""});this.setState(t),this.props.onSubmit(t)}}},{key:"handleCheckboxChange",value:function(e){this.setState({mode:e.target.checked}),this.props.onChangeMode(e.target.checked)}},{key:"validate",value:function(){var e=this.state,t=e.width,n=e.height,i=e.mines;if(t<=0)return this.setState({err:"Width shoud be a positive number"}),!1;if(t>this.props.maxWidth)return this.setState({err:"Max width is ".concat(this.props.maxWidth)}),!1;if(n<=0)return this.setState({err:"Height shoud be a positive number"}),!1;if(n>this.props.maxHeight)return this.setState({err:"Max height is ".concat(this.props.maxHeight)}),!1;var a=Math.floor(t*n/2);return!(a<i)||(this.setState({err:"Max count of mines is ".concat(a," - the count of cells divided by 2")}),!1)}},{key:"render",value:function(){var e=this;return a.a.createElement("div",{className:"dashboard"},a.a.createElement("form",{onSubmit:function(t){return e.handleSubmit(t)}},a.a.createElement("div",{className:"dasboard-row"},a.a.createElement("label",null,"width:",a.a.createElement("input",{name:"width",type:"text",value:this.state.width,onChange:function(t){return e.handleInputChange(t)}})),a.a.createElement("label",null,"height:",a.a.createElement("input",{name:"height",type:"text",value:this.state.height,onChange:function(t){return e.handleInputChange(t)}})),a.a.createElement("label",null,"mines:",a.a.createElement("input",{name:"mines",type:"text",value:this.state.mines,onChange:function(t){return e.handleInputChange(t)}}))),a.a.createElement("div",{className:"dashboard-row"},a.a.createElement("label",null,a.a.createElement("input",{name:"mode",label:"superman",type:"checkbox",value:"Superman",checked:this.state.mode,onChange:function(t){return e.handleCheckboxChange(t)}}),"superman"),a.a.createElement("button",{type:"submit",disabled:this.state.pendingRequest},"New game"))),a.a.createElement("div",{className:"dashboard-message"},this.state.err))}}]),n}(i.Component),m=n(6),f=function(e){var t=e.flags,n=e.message,i=e.color;return a.a.createElement("div",{className:"indication-panel"},a.a.createElement("div",null,"Flags remained: ",t),a.a.createElement("div",{className:i},n))},p=function(e){var t,n=e.x,s=e.y,h=e.cell,r=e.onOpen,o=e.onToggleFlag,l=["state-fill"];return h.isOpen&&l.push(h.isExploded?"exploded":"hidden"),t=h.isFlagged?a.a.createElement("i",{className:"fas fa-flag"}):h.isMined?a.a.createElement("i",{className:"fas fa-bomb"}):h.minesAround||"",a.a.createElement(i.Fragment,null,a.a.createElement("div",{className:l.join(" ")}),a.a.createElement("div",{className:"state-text",onClick:function(e){e.preventDefault(),e.stopPropagation(),e.shiftKey?o(n,s):r(n,s)}},t))},v=function(e){var t=e.cells,n=void 0===t?[]:t,i=e.onCellOpen,s=e.onCellToggleFlag,h=e.cellSize;return a.a.createElement("div",{className:"mine-field"},a.a.createElement("table",null,a.a.createElement("tbody",null,n.map((function(e,t){return a.a.createElement("tr",{key:t},e.map((function(e,n){return a.a.createElement("td",{className:"mine-cell",style:{width:"".concat(h,"px"),height:"".concat(h,"px")},key:n},a.a.createElement(p,{x:n,y:t,onOpen:i,onToggleFlag:s,cell:e}))})))})))))},y=function(){function e(){Object(o.a)(this,e),this.isOpen=!1,this.isFlagged=!1,this.isMined=!1,this.minesAround=0}return Object(l.a)(e,[{key:"getCellView",value:function(e){var t={isOpen:this.isOpen,isFlagged:this.isFlagged,isExploded:this.isExploded};return(e||this.isOpen)&&(t.isMined=this.isMined,t.minesAround=this.minesAround),t}},{key:"isExploded",get:function(){return this.isOpen&&this.isMined&&!this.isFlagged}}]),e}(),b=function(){function e(t){var n=t.width,i=t.height,a=t.mines;Object(o.a)(this,e),this.width=n,this.height=i,this.createMineSet(a),this.createField(),this.flagSet=new Set}return Object(l.a)(e,[{key:"createMineSet",value:function(e){var t=this,n=new Set;if(e instanceof Array)e.forEach((function(e){return n.add(t.hash(e.x,e.y))}));else for(var i=this.width,a=this.height,s=0;s<e;s++){var h=void 0,r=void 0,o=void 0;do{h=Math.floor(Math.random()*i),r=Math.floor(Math.random()*a),o=this.hash(h,r)}while(n.has(o));n.add(o)}this.mineSet=n}},{key:"hash",value:function(e,t){return"".concat(e,"_").concat(t)}},{key:"createField",value:function(){var e=this.width,t=this.height;this.mineFieldData=[];for(var n=0;n<t;n++){for(var i=[],a=0;a<e;a++){var s=new y;s.minesAround=this.getMinesAround(a,n),s.isMined=this.isMined(a,n),i.push(s)}this.mineFieldData.push(i)}}},{key:"getMinesAround",value:function(e,t){var n=this;return this.getNeighbours(e,t).reduce((function(e,t){return e+n.mineSet.has(n.hash(t.x,t.y))}),0)}},{key:"getNeighbours",value:function(e,t){for(var n=this.width,i=this.height,a=[],s=t-1;s<t+2;s++)for(var h=e-1;h<e+2;h++)h>=0&&h<n&&s>=0&&s<i&&(h!==e||s!==t)&&a.push({x:h,y:s});return a}},{key:"getCell",value:function(e,t){return this.mineFieldData[t][e]}},{key:"isMined",value:function(e,t){var n=this.hash(e,t);return this.mineSet.has(n)}},{key:"isFlagged",value:function(e,t){var n=this.hash(e,t);return this.flagSet.has(n)}},{key:"toggleFlag",value:function(e,t){var n=this.hash(e,t),i=this.getCell(e,t);this.isFlagged(e,t)?(this.flagSet.delete(n),i.isFlagged=!1):(this.flagSet.add(n),i.isFlagged=!0)}},{key:"getCellsToShow",value:function(e){return this.mineFieldData.map((function(t){return t.map((function(t){return t.getCellView(e)}))}))}},{key:"minesCount",get:function(){return this.mineSet.size}},{key:"flagsCount",get:function(){return this.flagSet.size}},{key:"cellsCount",get:function(){return this._cellCount||(this._cellCount=this.width*this.height),this._cellCount}}]),e}(),w=function(){function e(t){var n=t.width,i=t.height,a=t.mines,s=t.mode,h=t.field;Object(o.a)(this,e),this.godMode=s,this.openedCells=0,this.field=h||new b({width:n,height:i,mines:a}),this.status=0}return Object(l.a)(e,[{key:"getViewState",value:function(){var e=this.godMode||1===this.status||2===this.status;return{status:this.status,message:this.message,cells:this.field.getCellsToShow(e),flags:this.field.flagsCount}}},{key:"openCell",value:function(e,t){var n=this.field.getCell(e,t),i=n.isMined,a=n.isFlagged,s=n.isOpen;return!a&&i?this.processLoose(e,t):a||s||this.processOpen(e,t),this.getViewState()}},{key:"toggleFlagCell",value:function(e,t){var n=this.field;return n.getCell(e,t).isFlagged||n.flagsCount!==n.minesCount?(n.toggleFlag(e,t),this.message="",this.checkWin()):this.message="You are out of flags! You can pick up any unnecessary set flag",this.getViewState()}},{key:"setGodMode",value:function(e){return this.godMode=e,this.message="You turn god mode ".concat(e?"on":"off"),this.getViewState()}},{key:"processLoose",value:function(e,t){this.field.getCell(e,t).isOpen=!0,this.status=2,this.message="Sorry, you are lost the game :("}},{key:"processOpen",value:function(e,t){for(var n,i=this,a=[{x:e,y:t}];a.length;){var s=a.pop();(n=this.field.getCell(s.x,s.y)).isOpen=!0,this.openedCells++,n.minesAround||this.field.getNeighbours(s.x,s.y).forEach((function(e){var t=i.field.getCell(e.x,e.y);t.isOpen||(t.isOpen=!0,a.push(e))}))}this.message="",this.checkWin()}},{key:"checkWin",value:function(){this.openedCells+this.field.flagsCount===this.field.cellsCount&&(this.status=1,this.message="Congatulations! You win the game :)")}},{key:"inProgress",get:function(){return 0===this.status}},{key:"isWin",get:function(){return 1===this.status}},{key:"isLost",get:function(){return 2===this.status}}]),e}(),k=function(e){Object(u.a)(n,e);var t=Object(c.a)(n);function n(){var e;Object(o.a)(this,n);for(var i=arguments.length,a=new Array(i),s=0;s<i;s++)a[s]=arguments[s];return(e=t.call.apply(t,[this].concat(a))).state={},e.onCellOpen=function(e,t){this.engine.inProgress&&this.setState(this.engine.openCell(e,t))}.bind(Object(m.a)(e)),e.onCellToggleFlag=function(e,t){this.engine.inProgress&&this.setState(this.engine.toggleFlagCell(e,t))}.bind(Object(m.a)(e)),e}return Object(l.a)(n,[{key:"componentDidMount",value:function(){this.createNewGame()}},{key:"componentDidUpdate",value:function(e){this.engine.inProgress&&e&&e.mode!==this.props.mode&&this.setState(this.engine.setGodMode(this.props.mode))}},{key:"createNewGame",value:function(){var e=this.props,t=e.width,n=e.height,i=e.mines,a=e.mode,s=Math.max(Math.min((window.innerWidth-20)/t,window.innerHeight/2/n,50),20);this.engine=new w({width:t,height:n,mines:i,mode:a});var h=this.engine.getViewState();this.setState(Object(r.a)(Object(r.a)({},h),{},{cellSize:s}))}},{key:"render",value:function(){return a.a.createElement("div",{className:"game"},a.a.createElement(f,{flags:this.props.mines-this.state.flags,message:this.state.message,color:this.engine&&(this.engine.isWin?"green":this.engine.isLost?"red":"")}),a.a.createElement(v,{cells:this.state.cells,cellSize:this.state.cellSize,onCellOpen:this.onCellOpen,onCellToggleFlag:this.onCellToggleFlag}))}}]),n}(i.Component),C=function(e){Object(u.a)(n,e);var t=Object(c.a)(n);function n(){var e;Object(o.a)(this,n);for(var i=arguments.length,a=new Array(i),s=0;s<i;s++)a[s]=arguments[s];return(e=t.call.apply(t,[this].concat(a))).state={width:12,height:8,mines:9,mode:!1,key:1},e}return Object(l.a)(n,[{key:"newGame",value:function(e){var t=this.state.key+1;this.setState(Object(r.a)(Object(r.a)({},e),{},{key:t}))}},{key:"changeMode",value:function(e){this.setState({mode:e})}},{key:"render",value:function(){var e=this,t=this.state;return a.a.createElement("div",{className:"App"},a.a.createElement("header",{className:"App-header"},"Minesweeper"),a.a.createElement(g,{maxWidth:300,maxHeight:300,width:this.state.width,height:this.state.height,mines:this.state.mines,mode:this.state.mode,onSubmit:function(t){return e.newGame(t)},onChangeMode:function(t){return e.changeMode(t)}}),a.a.createElement(k,t))}}]),n}(i.PureComponent);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));h.a.render(a.a.createElement(C,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[10,1,2]]]);
//# sourceMappingURL=main.fc922b36.chunk.js.map